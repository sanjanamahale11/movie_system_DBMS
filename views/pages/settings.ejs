<!DOCTYPE html>
<html>
<head>
    <title>MovieTicks - Settings</title>
   <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="jquery.js"></script>
<style type="text/css">
    body{
    margin-top:20px;
    color: #1a202c;
    text-align: left;
    background-color: #e2e8f0;    
}
.main-body {
    padding: 15px;
}

.nav-link {
    color: #4a5568;
}
.card {
    box-shadow: 0 1px 3px 0 rgba(0,0,0,.1), 0 1px 2px 0 rgba(0,0,0,.06);
}

.card {
    position: relative;
    display: flex;
    flex-direction: column;
    min-width: 0;
    word-wrap: break-word;
    background-color: #fff;
    background-clip: border-box;
    border: 0 solid rgba(0,0,0,.125);
    border-radius: .25rem;
}

.card-body {
    flex: 1 1 auto;
    min-height: 1px;
    padding: 1rem;
}

.gutters-sm {
    margin-right: -8px;
    margin-left: -8px;
}

.gutters-sm>.col, .gutters-sm>[class*=col-] {
    padding-right: 8px;
    padding-left: 8px;
}
.mb-3, .my-3 {
    margin-bottom: 1rem!important;
}

.bg-gray-300 {
    background-color: #e2e8f0;
}
.h-100 {
    height: 100%!important;
}
.shadow-none {
    box-shadow: none!important;
}
.msg{
    color: red;
  }
  .thank-you-pop{
    width:100%;
    padding:20px;
    text-align:center;
}
.thank-you-pop img{
    width:76px;
    height:auto;
    margin:0 auto;
    display:block;
    margin-bottom:25px;
}

.thank-you-pop h1{
    font-size: 42px;
    margin-bottom: 25px;
    color:#5C5C5C;
}
.thank-you-pop p{
    font-size: 20px;
    margin-bottom: 27px;
    color:#5C5C5C;
}
.thank-you-pop h3.cupon-pop{
    font-size: 25px;
    margin-bottom: 40px;
    color:#222;
    display:inline-block;
    text-align:center;
    padding:10px 20px;
    border:2px dashed #222;
    clear:both;
    font-weight:normal;
}
.thank-you-pop h3.cupon-pop span{
    color:#03A9F4;
}
.thank-you-pop a{
    display: inline-block;
    margin: 0 auto;
    padding: 9px 20px;
    color: #fff;
    text-transform: uppercase;
    font-size: 14px;
    background-color: #8BC34A;
    border-radius: 17px;
}
.thank-you-pop a i{
    margin-right:5px;
    color:#fff;
}
#ignismyModal .modal-header{
    border:0px;
}


</style>
<script type="text/javascript">
    $(document).ready(function () {

     var old_pass = "<%=sess.old_pass%>";

      if(old_pass == "no")
        $(".pass1").hide();
     

    $('[data-toggle="tooltip"]').tooltip();   
     var x = "<%=pro_updated%>"
     
     if(x == "true")
    {
     $('#btnTrigger').click();
     $('.thank-you-pop p').text('Your Profile is updated successfully')
    }

     var msg4 = "<%=msg4%>";
     var pass_updated = "<%=pass_updated%>";
     if(msg4 == "security")
     {
        $('.nav-pills a[href="#security"]').tab('show'); 
     }
  
    if(pass_updated == "true")
    {
        $('#btnTrigger').click();
        $('.thank-you-pop p').text('Your Password is updated successfully')
    }

    })
</script>
</head>
<body>
     <div class="header-blue" style="padding-bottom: 25%;">
            
            <%- include('../partials/header'); %>

             <% if(typeof alert != 'undefined') { 
      msg0 = ""
      msg1 = ""
      msg2 = ""
      
      
      
         
             for(i=0;i< alert.length; i++) { 
                    

                     if(alert[i].param == "Fullname" )
                      msg0 = alert[i].msg 
                   
                     if(alert[i].param == "email" ) 
                     msg1 = alert[i].msg 
                    
                    
                     if(alert[i].param == "phone" ) 
                     msg2 = alert[i].msg 
                     

                     }

                     
                   }

                   %>

                   <% if(typeof alert2 != 'undefined') { 
                    
                    console.log(msg)
                   
                   msg1=msg } %>



        <div class="container">
      <div class="row gutters-sm">
        <div class="col-md-4  col-12">
          <div class="card">
            <div class="card-body">
              <nav class="nav flex-column nav-pills nav-gap-y-1">
                <a href="#profile" data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded active">
                  Profile Information
                </a>
                <a href="#account" data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded">
                Account Settings
                </a>
                <a href="#security"  data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded">
                  Security
                </a>
                </a>
                <a href="#billing" data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded">
                 Billing
                </a>
              </nav>
            </div>
          </div>
        </div>
        <div class="col-md-8 col-12">
          <div class="card">
           
            <div class="card-body tab-content">
              <div class="tab-pane active" id="profile">
                <h6>YOUR PROFILE INFORMATION</h6>
                <hr>
                <form action="/settings_script" method="POST">
                  <div class="form-group">
                    <label for="fullName">Full Name</label>
                    <input type="text" class="form-control" name="Fullname" placeholder="Enter your fullname" value="<%if(typeof alert!='undefined'||typeof alert2!= 'undefined'){%><%=data.Fullname%><%}else{%><%=Fullname%><%}%>">
                    <small  class="form-text text-muted">Your name may appear around here where you are mentioned. You can change or remove it at any time.</small>
                    <span class="msg"><%= typeof alert != 'undefined' ? msg0: '' %></span>
                  </div>
                  <div class="form-group">
                    <label for="bio">Email</label>
                      <input type="text" class="form-control" name="email" placeholder="Enter your email" value="<% if(typeof alert != 'undefined' || typeof alert2 != 'undefined') {%><%=data.email%><%}else{%><%=email%><%} %>" >
                      <span class="msg"><% if(typeof alert != 'undefined' || typeof alert2 != 'undefined') {%><%=msg1%><%}%></span>
                  </div>
                  <div class="form-group">
                    <label for="url">Phone Number</label>
                    <input type="number" class="form-control" name="phone" placeholder="Enter your phone number" value="<%if(typeof alert != 'undefined' ||  typeof alert2 != 'undefined'){%><%=data.phone%><%}else{%><%=phone%><%}%>" >
                    <span class="msg"><%= typeof alert != 'undefined' ? msg2: '' %></span>
                  </div>
                 
                  
                  <button type="submit" class="btn btn-primary">Update Profile</button>
                  
                </form>
              </div>
              <div class="tab-pane" id="account">
                <h6>ACCOUNT SETTINGS</h6>
                <hr>
                <form action="/settings_script2" method="POST">
                  <div class="form-group">
                    <label for="username">Email</label>
                    <input type="text" class="form-control" name="email" placeholder="Enter your email" value="<%=sess.email%>" readonly >
                    <small  class="form-text text-muted">After deleting your account all your information will be lost.</small>
                  </div>
                  <hr>
                  <div class="form-group">
                    <label class="d-block text-danger">Delete Account</label>
                    <p class="text-muted font-size-sm">Once you delete your account, there is no going back. Please be certain.</p>
                  </div>
                  <button class="btn btn-danger" type="button" data-toggle="modal" data-target="#exampleModal">Delete Account</button>

<div class="modal fade bd-example-modal-lg" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="exampleModalLabel" style="color: black;">Are you sure to delete your account PERMANENTLY</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h5 style="color: black;">This process cannot be undone</h5>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-danger">Confirm</button>
      </div>
    </div>
  </div>
</div>
                </form>
              </div>
              <div class="tab-pane" id="security">
                <h6>SECURITY SETTINGS</h6>
                <hr>
                <form action="/settings_script3" method="POST">
                  <div class="form-group">
                    <label class="d-block">Change Password</label>
                    <input type="text" name="pass1" class="form-control pass1"      placeholder="Enter your old password" >
                    <br>
                    <input type="text" name="pass2" class="form-control mt-1" placeholder="New password" required data-toggle="tooltip" data-container="body" data-placement="right" title="
          At least one special character 
          Minimum length should be 5 
          Should be one Uppercase 
          Should be one Lowercase 
          There should be one Number 
          White space not allowed">
                    <br>
                    <span class="msg"><%= typeof msg5 != 'undefined' ? msg5: '' %></span>
                    <br>
                    <input type="text" name="pass3" class="form-control mt-1" placeholder="Confirm new password" required>
                    <br>
                    <button class="btn btn-primary" type="submit">Change Password</button>
                  </div>
                  <span class="msg"><%= typeof msg3 != 'undefined' ? msg3: '' %></span>
                </form>
               
              </div>
              
              <div class="tab-pane" id="billing">
                <h6>YOUR BILLING</h6>
                <hr>
                <form>
                  
                  <div class="form-group mb-0">
                    <label class="d-block">Payment History</label>
                     
                     <%

                     if(sess.bill_total_rows > 0)
                     {
                        %>
                                              
                             <div class="table-responsive" style="max-height:560px;">
<table class="table table-bordered table-hover">
  <thead>
    <tr>
      <th scope="col">No</th>
      <th scope="col">Transaction date</th>
      <th scope="col">Movie</th>
      <th scope="col">Amount</th>
    </tr>
  </thead>
  <tbody>
    <%
     
     for(i=sess.bill_total_rows-1; i>=0 ;i--)

     {
      
     %>
    <tr>
      <th scope="row"><%=sess.bill_total_rows-i%></th>
      <td><%=sess.bill_transaction_date[i]%></td>
      <% 
       
        if(sess.bill_status[i] == "CONFIRMED")
        {

         %>
         <td>Paid for movie <%=sess.bill_title[i]%></td>
         <td style="color: red; font-size: small;"><span>- &nbsp &nbsp</span><span>&#x20b9; </span><%=sess.bill_Total_price_paid[i]%></td>
         <%
        
        }
        else if(sess.bill_status[i] == "CANCELLED")
        {

         %><td>Refund for movie <%=sess.bill_title[i]%></td> <%
        
         if(sess.bill_Total_price_refund[i] == undefined )
         {
           %><td style="color: green; font-size: small;"><span>+ &nbsp &nbsp</span><span>&#x20b9; </span><%=sess.bill_Total_price_paid[i]%></td><%
         }
         
         else
         {
           %><td style="color: green; font-size: small;"><span>+ &nbsp &nbsp</span><span>&#x20b9; </span><%=sess.bill_Total_price_refund[i]%></td><%
         }
         
         
        
        
        }

       %>
      
    </tr>
    
    <%
     }

    %>
      
  </tbody>
</table>

</div>


























                        <%
                     }
                     else
                     {

                         %><div class="border border-gray-500 bg-gray-200 p-3 text-center font-size-sm">You have not made any payment.</div><%

                     }
                    

                    %>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
</div>



<div class="container">
    <div class="row">
        <a class="btn btn-primary" id="btnTrigger" data-toggle="modal" href="#ignismyModal" style="display: none;">open Popup</a>
        <div class="modal fade" id="ignismyModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label=""><span>×</span></button>
                     </div>
                    
                    <div class="modal-body">
                       
                        <div class="thank-you-pop">
                            <img src="Green-Round-Tick.png" alt="">
                            <h1>Success!</h1>
                            <p></p>
                        </div>
                         
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>